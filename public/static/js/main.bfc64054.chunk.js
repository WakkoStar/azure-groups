(this.webpackJsonpazure_groups_final=this.webpackJsonpazure_groups_final||[]).push([[0],{10:function(e,t){e.exports={appId:"a597208d-3e9b-4926-bd6d-0415c98c2bc4",scopes:["User.ReadWrite.All","Directory.ReadWrite.All","User.Invite.All","GroupMember.ReadWrite.All","Group.ReadWrite.All","UserActivity.ReadWrite.CreatedByApp"]}},36:function(e,t){e.exports=[{name:"Habitat.gpseo",id:"ee109a66-f87d-4933-8cc1-562047148e39"},{name:"Communes.gpseo",id:"325b8174-e8ad-45dd-94c1-94ee8da896f1"}]},41:function(e,t,n){e.exports=n(57)},46:function(e,t,n){},55:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(31),u=n.n(c),i=(n(46),n(0)),s=n.n(i),o=n(6),l=n(13),p=n(15),m=n(19),f=n(37),d=n(59),h=function(e){return a.a.createElement("header",null,a.a.createElement("nav",null,a.a.createElement("div",null,a.a.createElement("img",{src:"https://upload.wikimedia.org/wikipedia/fr/8/87/Grand_paris_seine_et_oise.png",alt:""}),a.a.createElement("h1",null,"Azure groups")),a.a.createElement("ul",null,a.a.createElement(d.a,null,a.a.createElement(m.b,{to:"/",className:"nav-link",exact:!0},"Connexion")),e.isAuthenticated?a.a.createElement(d.a,null,a.a.createElement(m.b,{to:"/liste-utilisateur",className:"nav-link",exact:!0},"Groupes")):"")))},v=function(e){var t=function(){return e.isAuthenticated?a.a.createElement("article",null,a.a.createElement("h1",null,e.user.name),a.a.createElement("h2",null,"Bienvenue dans votre espace AZURE GROUPS"),a.a.createElement("div",null,a.a.createElement("button",{onClick:e.authButtonMethod},"Se deconnecter"),a.a.createElement("p",null,"Vous \xeates connect\xe9"))):a.a.createElement("article",null,a.a.createElement("div",null,a.a.createElement("button",{onClick:e.authButtonMethod},"Se connecter"),a.a.createElement("p",null,"Veuillez vous connecter")))};return a.a.createElement("section",{id:"Jumbotron"},a.a.createElement(t,{isAuthenticated:e.isAuthenticated,user:e.user,authButtonMethod:e.authButtonMethod}))},b=n(10),E=n.n(b),w=n(56);function x(e){return w.Client.init({authProvider:function(t){t(null,e.accessToken)}})}function g(e){return k.apply(this,arguments)}function k(){return(k=Object(o.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=x(t),e.next=3,n.api("/me").get();case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t){return j.apply(this,arguments)}function j(){return(j=Object(o.a)(s.a.mark((function e(t,n){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x(t),e.next=3,r.api("/users").select("id,displayName,mail").get();case 3:if(a=e.sent,""===n){e.next=8;break}return e.next=7,r.api("/users").select("id,displayName,mail").filter("startswith(mail,'"+n+"')").get();case 7:a=e.sent;case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){return A.apply(this,arguments)}function A(){return(A=Object(o.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.invitedUser.id,e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t){return C.apply(this,arguments)}function C(){return(C=Object(o.a)(s.a.mark((function e(t,n){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x(t),e.next=3,r.api("/invitations").post({invitedUserEmailAddress:n.toLowerCase(),inviteRedirectUrl:"https://azure-groups.herokuapp.com/",sendInvitationMessage:!0,invitedUserDisplayName:n.slice(0,n.indexOf("@")).toLowerCase()});case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t,n){return N.apply(this,arguments)}function N(){return(N=Object(o.a)(s.a.mark((function e(t,n,r){var a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x(t),c=a.api("/groups/"+n+"/members/$ref").post({"@odata.id":"https://graph.microsoft.com/v1.0/users/"+r}),e.abrupt("return",c);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t,n){return _.apply(this,arguments)}function _(){return(_=Object(o.a)(s.a.mark((function e(t,n,r){var a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x(t),e.next=3,a.api("/groups/"+n+"/members/"+r+"/$ref").delete();case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t){return I.apply(this,arguments)}function I(){return(I=Object(o.a)(s.a.mark((function e(t,n){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x(t),e.next=3,r.api("groups/"+n+"/members").get();case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,n){return T.apply(this,arguments)}function T(){return(T=Object(o.a)(s.a.mark((function e(t,n,r){var a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x(t),e.next=3,a.api("/groups/"+n+"/owners/"+r+"/$ref").get();case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t,n){return B.apply(this,arguments)}function B(){return(B=Object(o.a)(s.a.mark((function e(t,n,r){var a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:return a=e.sent,c=[],n.map(function(){var e=Object(o.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M(t,n.id,a.id);case 3:c.push(n),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var G=function(e){var t=e.groups,n=Object(r.useState)({}),c=Object(l.a)(n,2),u=c[0],i=c[1],p=Object(r.useState)({id:""}),m=Object(l.a)(p,2),f=m[0],d=m[1],h=Object(r.useState)([]),v=Object(l.a)(h,2),b=v[0],w=v[1],x=Object(r.useState)([]),g=Object(l.a)(x,2),k=g[0],j=g[1],A=Object(r.useState)(void 0),C=Object(l.a)(A,2),N=C[0],_=C[1];Object(r.useEffect)((function(){T("")}),[e]);var I=function(){var e=Object(o.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.msal.acquireTokenSilent({scopes:E.a.scopes});case 2:z(e.sent,f.id).then((function(e){for(var n=e.value,r=0;r<n.length;r++)n[r].mail||(n[r].mail=n[r].displayName);var a=n.filter((function(e){return e.mail.includes(t)}));w(a)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(o.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d({id:t,name:n}),e.next=3,window.msal.acquireTokenSilent({scopes:E.a.scopes});case 3:z(e.sent,t).then((function(e){w(e.value)}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),T=function(){var e=Object(o.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.msal.acquireTokenSilent({scopes:E.a.scopes});case 2:y(e.sent,t).then((function(e){j(e.value)})),_(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(o.a)(s.a.mark((function e(t,n){var r,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.msal.acquireTokenSilent({scopes:E.a.scopes});case 2:if(r=e.sent,""!==(a=t)){e.next=11;break}return e.next=7,S(r,n);case 7:return c=e.sent,e.next=10,O(c);case 10:a=e.sent;case 11:return e.next=13,R(r,f.id,a);case 13:alert(n+" \xe0 \xe9t\xe9 ajout\xe9 au groupe "+f.name),window.location.reload();case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),B=function(){var e=Object(o.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.msal.acquireTokenSilent({scopes:E.a.scopes});case 2:return n=e.sent,e.next=5,S(n,t.mail);case 5:alert("Une invitation \xe0 \xe9t\xe9 envoy\xe9e \xe0 "+t.mail);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(o.a)(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.msal.acquireTokenSilent({scopes:E.a.scopes});case 2:return r=e.sent,e.next=5,U(r,t,n.id);case 5:alert("L'utilisateur "+n.mail+" \xe0 \xe9t\xe9 supprim\xe9 "),window.location.reload();case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),L=function(e){var t=e.user,n=e.i;if(null===t)return""!==f.id?a.a.createElement("li",null,a.a.createElement("p",null,N),a.a.createElement("button",{onClick:function(){return q("",N)}},"Inviter")):a.a.createElement("li",null,a.a.createElement("p",null,"Veuillez selectionnez un groupe"));for(var r=!1,c=0;c<b.length;c++)b[c].id===t.id&&(r=!0);return!r&&a.a.createElement("li",{key:n},a.a.createElement("p",null,t.displayName),a.a.createElement("button",{onClick:function(){return q(t.id,t.mail)}},"Inviter"))},W=function(){for(var e=[],t=function(){var t=b[n];e[n]=a.a.createElement("tr",{style:{backgroundColor:t.id===u.id?"#dee2e6":"transparent"}},a.a.createElement("th",{scope:"row",key:n},n),a.a.createElement("td",null,t.displayName),a.a.createElement("td",null,t.mail),a.a.createElement("td",{onClick:function(){return i(t)}},a.a.createElement("button",null,"S\xe9lectionner")))},n=0;n<b.length;n++)t();return e},V=function(e){var t=e.group,n=e.i;return a.a.createElement("button",{onClick:function(){return M(t.id,t.name)},key:n,className:f.id===t.id?"selected":"not-selected"},t.name)};return a.a.createElement("section",{id:"Groups"},a.a.createElement("article",null,a.a.createElement("div",{id:"group_nav"},t.length>0?t.map((function(e,t){return a.a.createElement(V,{group:e,i:t})})):a.a.createElement("p",null,"Aucun groupe")),a.a.createElement("div",{style:{width:"100%"},id:"search"},a.a.createElement("h2",null,"Rechercher un membre "),""!==f.id?a.a.createElement("input",{type:"text",placeholder:"Rechercher par mail",onChange:function(e){return I(e.target.value)}}):a.a.createElement("p",null,"Veuillez s\xe9lectionnez un groupe")),a.a.createElement("div",{id:"table"},a.a.createElement("table",null,a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",{scope:"col"},"#"),a.a.createElement("th",{scope:"col"},"Login"),a.a.createElement("th",{scope:"col"},"Mail"),a.a.createElement("th",{scope:"col"},"Modifier"))),a.a.createElement("tbody",null,a.a.createElement(W,null)))),a.a.createElement("div",{id:"member_nav"},a.a.createElement("div",{style:{height:"20%"}},a.a.createElement("h2",null,"Modifier un membre"),a.a.createElement("p",null,"S\xe9lection : ",a.a.createElement("strong",null,u.displayName)),a.a.createElement("button",{onClick:function(){return B(u)},style:{marginRight:"0.5vw"},disabled:!u.id},"R\xe9inviter"),a.a.createElement("button",{onClick:function(){return G(f.id,u)},disabled:!u.id},"Supprimer")),a.a.createElement("div",{style:{height:"80%"}},a.a.createElement("div",{className:"form"},a.a.createElement("h2",null,"Ajouter un membre"),a.a.createElement("input",{type:"text",name:"email",placeholder:"Rechercher par mail",onChange:function(e){return T(e.target.value)}}),a.a.createElement("div",null,a.a.createElement("ul",null,k.length>0&&b.length>0?k.map((function(e,t){return a.a.createElement(L,{user:e,i:t})})):a.a.createElement(L,{user:null,i:0}))))))))},L=n(36),W=n.n(L),V=(n(55),function(){var e=Object(r.useState)({isAuth:!1,name:""}),t=Object(l.a)(e,2),n=t[0],c=t[1],u=Object(r.useState)([]),i=Object(l.a)(u,2),d=i[0],b=i[1],w=Object(r.useState)(void 0),x=Object(l.a)(w,2),k=x[0],y=x[1];Object(r.useEffect)((function(){j()}),[]);var j=function(){var e=Object(o.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=new f.a({auth:{clientId:E.a.appId,authority:"https://login.microsoftonline.com/fd87095d-65db-4894-98c3-4f76bdd06eb2",redirectURI:"https://azure-groups.herokuapp.com/"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}}),!t.getAccount()){e.next=5;break}return e.next=5,A(t);case 5:y(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(o.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.msal.acquireTokenSilent({scopes:E.a.scopes});case 2:q(e.sent,W.a).then((function(e){b(e),c({isAuth:!0,name:t.displayName})}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(o.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.acquireTokenSilent({scopes:E.a.scopes,authority:"https://login.microsoftonline.com/fd87095d-65db-4894-98c3-4f76bdd06eb2"});case 2:(n=e.sent)&&g(n).then(function(){var e=Object(o.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k&&k.loginPopup({scopes:E.a.scopes,prompt:"select_account"}).then(Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(k);case 2:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){k.logout()},R=function(){return n.isAuth?a.a.createElement(p.a,{exact:!0,path:"/liste-utilisateur"},a.a.createElement(G,{groups:d})):""};return a.a.createElement(m.a,null,a.a.createElement(h,{isAuthenticated:n.isAuth}),a.a.createElement(p.a,{exact:!0,path:"/",render:function(){return a.a.createElement(v,{isAuthenticated:n.isAuth,user:n,authButtonMethod:n.isAuth?C:S})}}),a.a.createElement(R,null))});u.a.render(a.a.createElement(V,null),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.bfc64054.chunk.js.map